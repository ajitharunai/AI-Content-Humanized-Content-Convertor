<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>All-in-One Calculator</title>
  <meta name="description" content="Professional, responsive all-in-one calculator: basic, scientific, programmer, unit converter." />
  <style>
    /* --- Theme adapted from provided watercolor hero (light, editorial, serif headline) --- */
    :root{
      --bg: #ffffff;
      --page-max:1100px;
      --muted: #7a7a7a;
      --muted-2:#9aa0a6;
      --accent:#94c948; /* green from image */
      --card:#f7faf9;
      --glass: rgba(255,255,255,0.6);
      --radius:18px;
      --shadow:0 10px 30px rgba(20,30,40,0.06);
      --serif: Georgia, 'Times New Roman', Times, serif;
      --sans: Inter, ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:var(--bg); color:#111827; font-family:var(--sans); -webkit-font-smoothing:antialiased;
      display:flex; align-items:flex-start; justify-content:center; padding:48px 24px;
    }

    .container{
      width:100%; max-width:var(--page-max); text-align:center;
    }

    /* Editorial hero */
    .hero{
      margin:0 auto 28px auto; padding:28px 18px 46px; position:relative; border-radius:14px; overflow:visible;
    }

    .eyebrow{font-size:12px; letter-spacing:6px; color:var(--muted); text-transform:uppercase; margin-bottom:12px}
    .headline{
      font-family:var(--serif); font-size:56px; line-height:1.02; margin:0 0 12px; color:#111;
      font-weight:400; letter-spacing:-0.5px;
    }
    .subhead{color:var(--muted); font-size:18px; margin:0 auto 24px; max-width:820px}

    /* Watercolor panel that will hold the calculator */
    .water-panel{
      margin:26px auto 0; width:100%; max-width:920px; height:220px; border-radius:14px; position:relative;
      background-image: url('/mnt/data/ea242635-3d5a-44eb-8d2d-890218f8fc8c.png');
      background-size:cover; background-position:center; display:flex; align-items:center; justify-content:center; box-shadow:var(--shadow);
    }

    /* Glassy inner card (calculator) */
    .card{
      width:86%; max-width:760px; background:linear-gradient(180deg, rgba(255,255,255,0.9), rgba(255,255,255,0.85)); border-radius:12px; padding:20px; box-shadow:0 6px 18px rgba(10,10,10,0.06);
      display:grid; grid-template-columns:280px 1fr; gap:18px; align-items:start;
    }

    /* Left column: compact calculator */
    .left{display:flex; flex-direction:column; gap:12px}
    .brand{ text-align:left }
    .brand h2{font-family:var(--serif); margin:0; font-size:20px; color:#0b1220}
    .brand p{margin:0;color:var(--muted);font-size:13px}

    .display{background:#fff; border-radius:10px; padding:16px; min-height:84px; display:flex;flex-direction:column; gap:6px; align-items:flex-end; justify-content:center; border:1px solid rgba(15,20,24,0.04)}
    .expression{color:var(--muted-2); font-size:13px; width:100%; text-align:right; word-break:break-all}
    .result{font-family:var(--serif); font-size:28px; font-weight:600; color:#0b1220}

    .controls{display:flex; gap:8px; flex-wrap:wrap}
    .small-btn{padding:8px 10px; border-radius:8px; border:1px solid rgba(10,10,10,0.06); background:transparent; color:var(--muted); cursor:pointer; font-size:13px}

    .pad{display:grid;grid-template-columns:repeat(4,1fr);gap:8px}
    button.key{padding:12px;border-radius:8px;border:0;background:transparent;color:#111;font-size:15px;cursor:pointer;border:1px solid rgba(10,10,10,0.04)}
    button.key.op{color:var(--accent); font-weight:600}
    button.key.wide{grid-column:span 2}

    /* Right column: panels */
    .right{padding:6px}
    .mode-panel{display:none}
    .mode-panel.active{display:block}
    .mode-panel h3{font-family:var(--serif); margin:0 0 8px; font-size:18px}
    .mode-panel p{margin:0;color:var(--muted)}

    .converter .field label{display:block; font-size:12px; color:var(--muted); margin-bottom:6px}

    .history{max-height:120px;overflow:auto;background:transparent;padding:6px;border-radius:8px}
    .history-item{display:flex;justify-content:space-between;padding:6px 8px;font-size:13px;color:var(--muted)}

    footer{display:flex;justify-content:space-between;align-items:center;color:var(--muted);font-size:12px;margin-top:10px}

    /* responsive adjustments */
    @media (max-width:900px){
      .card{grid-template-columns:1fr;}
      .water-panel{height:420px}
      .headline{font-size:36px}
    }

    /* focus */
    button:focus, select:focus, input:focus{outline:2px solid rgba(148,201,72,0.18);outline-offset:3px}
  </style>
</head>
<body>
  <main class="app" role="application" aria-label="All in One Calculator">
    <section class="left">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div class="brand">
          <h2>All‑in‑One Calculator</h2>
          <p>Basic · Scientific · Programmer · Unit Converter</p>
        </div>
      </div>

      <div class="display" id="display" aria-live="polite">
        <div class="expression" id="expression">0</div>
        <div class="result" id="result">0</div>
      </div>

      <div class="controls">
        <button class="small-btn" id="copyBtn">Copy</button>
        <button class="small-btn" id="clearHistoryBtn">Clear History</button>
        <button class="small-btn" id="themeBtn" aria-pressed="false">Toggle Theme</button>
      </div>

      <div class="pad" id="pad" aria-label="calculator keypad">
        <!-- row 1 -->
        <button class="key op" data-val="%">%</button>
        <button class="key" data-val="(">(</button>
        <button class="key" data-val=")">)</button>
        <button class="key op" data-val="\/">÷</button>

        <!-- row 2 -->
        <button class="key" data-val="7">7</button>
        <button class="key" data-val="8">8</button>
        <button class="key" data-val="9">9</button>
        <button class="key op" data-val="*">×</button>

        <!-- row 3 -->
        <button class="key" data-val="4">4</button>
        <button class="key" data-val="5">5</button>
        <button class="key" data-val="6">6</button>
        <button class="key op" data-val="-">−</button>

        <!-- row 4 -->
        <button class="key" data-val="1">1</button>
        <button class="key" data-val="2">2</button>
        <button class="key" data-val="3">3</button>
        <button class="key op" data-val="+">+</button>

        <!-- row 5 -->
        <button class="key" data-val="0">0</button>
        <button class="key" data-val=".">.</button>
        <button class="key" id="backspace">⌫</button>
        <button class="key wide op" id="equals">=</button>
      </div>

      <div class="history" id="history" aria-label="calculation history">
        <!-- history items go here -->
      </div>

      <footer>
        <div>Built with HTML5 · CSS · Vanilla JS</div>
        <div id="version">v1.0</div>
      </footer>
    </section>

    <section class="right">
      <div class="mode-panel active" data-panel="basic">
        <h3>Basic</h3>
        <p class="muted">Standard arithmetic operations with history and copy support.</p>
      </div>

      <div class="mode-panel" data-panel="scientific">
        <h3>Scientific</h3>
        <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px">
          <button class="small-btn sci" data-fn="sin">sin</button>
          <button class="small-btn sci" data-fn="cos">cos</button>
          <button class="small-btn sci" data-fn="tan">tan</button>
          <button class="small-btn sci" data-fn="ln">ln</button>
          <button class="small-btn sci" data-fn="log">log</button>
          <button class="small-btn sci" data-fn="sqrt">√</button>
          <button class="small-btn sci" data-fn="^">xʸ</button>
          <button class="small-btn sci" data-fn="!">n!</button>
          <button class="small-btn sci" data-fn="pi">π</button>
        </div>
      </div>

      <div class="mode-panel" data-panel="programmer">
        <h3>Programmer</h3>
        <div style="display:flex;gap:8px;margin-bottom:8px">
          <select id="baseSelect" aria-label="number base"><option value="10">Decimal</option><option value="2">Binary</option><option value="8">Octal</option><option value="16">Hex</option></select>
          <button class="small-btn" id="bitwiseAnd">AND</button>
          <button class="small-btn" id="bitwiseOr">OR</button>
        </div>
        <div style="font-size:13px;color:var(--muted)">Enter values in selected base; buttons will convert and evaluate using JS integers.</div>
      </div>

      <div class="mode-panel" data-panel="converter">
        <h3>Unit Converter</h3>
        <div class="converter">
          <div class="field">
            <label for="convertValue">Value</label>
            <input id="convertValue" type="number" value="1" />
          </div>
          <div class="field">
            <label for="convertType">Category</label>
            <select id="convertType">
              <option value="length">Length</option>
              <option value="weight">Weight</option>
              <option value="temperature">Temperature</option>
            </select>
          </div>

          <div class="field">
            <label for="fromUnit">From</label>
            <select id="fromUnit"></select>
          </div>
          <div class="field">
            <label for="toUnit">To</label>
            <select id="toUnit"></select>
          </div>

          <div class="field" style="grid-column:1/3">
            <label>Result</label>
            <div id="convertResult" style="padding:8px;background:rgba(255,255,255,0.02);border-radius:8px;min-height:40px"></div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <script>
    // === Core state ===
    const displayEl = document.getElementById('display');
    const exprEl = document.getElementById('expression');
    const resEl = document.getElementById('result');
    const pad = document.getElementById('pad');
    const historyEl = document.getElementById('history');

    let expression = '';
    let history = [];
    let currentMode = 'basic';

    // Helpers
    const setExpression = v => { expression = v; exprEl.textContent = v || '0'; };
    const setResult = v => { resEl.textContent = v; };
    const pushHistory = (expr, value) => { history.unshift({expr,value,time: new Date().toISOString()}); renderHistory(); };
    const renderHistory = ()=>{
      historyEl.innerHTML=''; history.forEach(h=>{
        const d = document.createElement('div'); d.className='history-item'; d.textContent = `${h.expr} = ${h.value}`; historyEl.appendChild(d);
      })
    }

    // Basic keypad
    pad.addEventListener('click', e=>{
      const b = e.target.closest('button'); if(!b) return;
      if(b.id === 'equals') return evaluate();
      if(b.id === 'backspace') { setExpression(expression.slice(0,-1)); return; }
      const val = b.dataset.val;
      if(!val) return;
      // map division char
      const mapped = val === '\\/' ? '/' : val;
      setExpression(expression + mapped);
    });

    // keyboard support
    window.addEventListener('keydown', e=>{
      if(e.key === 'Enter') { e.preventDefault(); evaluate(); }
      else if(e.key === 'Backspace') { setExpression(expression.slice(0,-1)); }
      else if(/^[0-9.+\-*/()%]$/.test(e.key)) { setExpression(expression + e.key); }
    });

    // evaluate safely using Function (not eval) and basic sanitization
    function evaluate(){
      if(!expression) return;
      try{
        // Disallow characters other than digits, operators, decimal, parentheses
        if(!/^[0-9+\-*/().% \s]*$/.test(expression)){
          setResult('Error'); return;
        }
        // Replace percent: treat x% as (x/100)
        const expr = expression.replace(/(\d+(?:\.\d+)?)%/g, '($1/100)');
        const fn = new Function('return ('+expr+')');
        const value = fn();
        setResult(Number.isFinite(value) ? value : 'Error');
        pushHistory(expression, value);
      }catch(err){ setResult('Error'); }
    }

    // mode controls
    document.querySelectorAll('.mode-btn').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        document.querySelectorAll('.mode-btn').forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        currentMode = btn.dataset.mode;
        document.querySelectorAll('.mode-panel').forEach(p=>p.classList.remove('active'));
        document.querySelector(`[data-panel="${currentMode}"]`).classList.add('active');
      })
    });

    // scientific functions
    document.querySelectorAll('.sci').forEach(b=>b.addEventListener('click', ()=>{
      const fn = b.dataset.fn;
      if(fn === 'pi') setExpression(expression + Math.PI);
      else if(fn === '^') setExpression(expression + '**');
      else if(fn === 'sqrt') setExpression(expression + 'Math.sqrt(');
      else if(['sin','cos','tan','log','ln'].includes(fn)) setExpression(expression + `Math.${fn === 'ln' ? 'log' : fn}(`);
      else if(fn === '!') setExpression(expression + 'factorial(');
    }));

    // factorial helper for expression evaluation
    function factorial(n){ if(n<2) return 1; let r=1; for(let i=2;i<=n;i++) r*=i; return r }
    // expose factorial to global scope for Function to use
    window.factorial = factorial;

    // copy result
    document.getElementById('copyBtn').addEventListener('click', async ()=>{
      try{ await navigator.clipboard.writeText(resEl.textContent); alert('Result copied'); }catch(e){ alert('Copy failed'); }
    });

    // clear history
    document.getElementById('clearHistoryBtn').addEventListener('click', ()=>{ history=[]; renderHistory(); });

    // theme toggle (simple invert)
    document.getElementById('themeBtn').addEventListener('click', e=>{
      const pressed = e.currentTarget.getAttribute('aria-pressed') === 'true';
      e.currentTarget.setAttribute('aria-pressed', String(!pressed));
      if(!pressed) document.documentElement.style.setProperty('--bg','#f8fafc');
      else document.documentElement.style.removeProperty('--bg');
      // simple visual feedback — expand as needed
      alert('Theme toggle (demo): expand in CSS as required');
    });

    // Programmer base handling (simple conversion helpers)
    document.getElementById('baseSelect').addEventListener('change', ()=>{
      // Set note — a fuller implementation would re-render keypad & conversions
      alert('Base changed to ' + document.getElementById('baseSelect').value + '. Enter values and press = to evaluate.');
    });

    // Unit converter data & logic (local, no web calls)
    const units = {
      length: { base: 'm', units: { m:1, km:1000, cm:0.01, mm:0.001, inch:0.0254, ft:0.3048 } },
      weight: { base: 'kg', units: { kg:1, g:0.001, lb:0.453592, oz:0.0283495 } },
      temperature: { base: 'C', units: { C:'C', F:'F', K:'K' } }
    };

    const fromUnit = document.getElementById('fromUnit');
    const toUnit = document.getElementById('toUnit');
    const convertType = document.getElementById('convertType');

    function populateUnits(){
      const cat = convertType.value;
      fromUnit.innerHTML=''; toUnit.innerHTML='';
      Object.keys(units[cat].units).forEach(u=>{ fromUnit.appendChild(new Option(u,u)); toUnit.appendChild(new Option(u,u)); });
      computeConversion();
    }
    convertType.addEventListener('change', populateUnits);
    fromUnit.addEventListener('change', computeConversion);
    toUnit.addEventListener('change', computeConversion);
    document.getElementById('convertValue').addEventListener('input', computeConversion);

    function computeConversion(){
      const cat = convertType.value; const v = Number(document.getElementById('convertValue').value) || 0;
      if(cat !== 'temperature'){
        const fromFactor = units[cat].units[fromUnit.value];
        const toFactor = units[cat].units[toUnit.value];
        const base = v * fromFactor; // in base unit
        const result = base / toFactor;
        document.getElementById('convertResult').textContent = result;
      }else{
        // temperature conversions
        const from = fromUnit.value, to = toUnit.value;
        let val = v;
        // convert to C
        if(from === 'F') val = (v - 32) * 5/9;
        if(from === 'K') val = v - 273.15;
        // convert from C to target
        if(to === 'F') val = (val * 9/5) + 32;
        if(to === 'K') val = val + 273.15;
        document.getElementById('convertResult').textContent = Number.isFinite(val) ? val : 'Error';
      }
    }

    // initialize UI
    setExpression(''); setResult('0'); populateUnits();
  </script>
</body>
</html>
